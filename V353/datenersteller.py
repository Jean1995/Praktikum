import matplotlib.pyplot as plt
import numpy as np
import uncertainties.unumpy as unp
from uncertainties.unumpy import (
    nominal_values as noms,
    std_devs as stds,
)
from table import (
    make_table,
    make_SI,
    write,
)
from uncertainties import ufloat

#b und c)
f   = np.array([50, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 6000, 7000, 8000, 9000, 10000, 12500, 15000, 20000, 25000, 30000, 35000, 40000, 45000, 50000, 75000, 100000])
a   = np.array([900, 800, 720, 660, 600, 560, 504, 448, 416, 380, 352, 332, 312, 296, 284, 268, 256, 244, 234, 224, 204, 192, 178, 164, 154, 144, 138, 130, 124, 118, 96.8, 80, 69.6, 61.6, 53.6, 49.2, 41.2, 35.2, 31.2, 27.4, 24.4, 19.8, 16.2, 12.2, 9.76, 8.24, 6.96, 6.08, 5.36, 4.8, 3.24, 2.5])
b   = f*0 + 1/f*10**(6)
U_c = np.array([18400, 17200, 15200, 13600, 12200, 10800, 9360, 8560, 7760, 7040, 6480, 6000, 5600, 5200, 4920, 4640, 4360, 4120, 3920, 3760, 3440, 3180, 2880, 2700, 2540, 2380, 2220, 2100, 2020, 1900, 1540, 1270, 1100, 960, 856, 768, 628, 544, 476, 424, 380, 300, 256, 192, 154, 128, 110, 97.6, 86.4, 77.6, 52, 39.2])
write('build/bctabelle.tex', make_table([f, U_c, a, b], [0,1,2,2]))
U_c = U_c * 10**(-3)
a   = a * 10**(-6)
b   = b * 10**(-6)
np.savetxt('bc.txt', np.column_stack([f, U_c, a, b]), header="f [Hz], U_c [V], a [s], b [s]")


#52 Messwerte
